#!/usr/bin/env bash
root=${ALGO:=$HOME/Code/algos}
for filepath in $*; do
    if test -d $filepath; then
        echo "==> Problem $filepath already exist."
        exit 1
    fi
    mkdir -p $filepath
    filename=$(basename "$filepath")
    ctime=$(date)
    sed -e "s/\\\$NAME/$filename/g" \
        -e "s/\\\$DATE/$ctime/g" \
        "$root/template.cpp" > $filepath/$filename.cpp
    sed "s|\\\$ALGOLIB|$root|g" "$root/Makefile" > $filepath/Makefile
    touch $filepath/ins.in
    echo "==> Problem $filepath created."
    subl $filepath/test.rel
    cd $filepath
    subl ./*
    algo-make
done
